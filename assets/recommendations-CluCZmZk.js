import{u as W,_ as A}from"./VideoDisplay.scss_vue_type_style_index_0_src_true_lang-DxZ0VA9B.js";import{f as G,r as p,o as C,g as U,d as $,m as J,h as L,w as H,u as N,i as D,s as Y,j as q,c as w,k as T,b as y,n as K,l as B,F as Q,p as Z,e as S,q as c,t as I}from"./index-BdAOosat.js";import{u as R}from"./useThrottle-aDuC7O3A.js";import{u as ee}from"./useMockApi-gST0Mk85.js";const se=G("videoSlider",()=>{const a=p(0),l=p(!1);return{offset:a,expanded:l,setOffset:s=>{a.value=s},switchExpanded:()=>{l.value=!l.value}}}),te=a=>{const l=p([]),t=s=>{if(!l.value.length)return;const r=s.deltaX,n=s.deltaY;let o;Math.abs(n)>Math.abs(r)?o=n>0?"down":"up":o=r>0?"right":"left",l.value.forEach(v=>v(o))};return C(()=>{const s=a==null?void 0:a.value;s&&s.addEventListener("wheel",t)}),U(()=>{const s=a==null?void 0:a.value;s&&s.removeEventListener("wheel",t)}),{onScroll:s=>(l.value.push(s),()=>{l.value=l.value.filter(r=>r!==s)})}},oe=["data-scroll-index","data-item-active"],ae=$({__name:"VideoSlider",props:J({modelValue:{},loading:{type:Boolean},items:{default:()=>[]}},{modelValue:{default:0},modelModifiers:{},loading:{type:Boolean,default:!1},loadingModifiers:{}}),emits:["update:modelValue","update:loading"],setup(a){const l=a,t=L(a,"modelValue"),g=L(a,"loading");H(()=>t.value,(e,d)=>{e!==d&&V()});const{isTablet:s}=N(),r=p(0),n=D(()=>{let e=j.value+r.value;return g.value&&(i!=null&&i.value)&&(e+=i.value.clientHeight),{transform:`translateY(${e}px)`}}),o=p(0),v=D(()=>({transform:`rotate(${o.value}deg)`})),E=D(()=>g.value?"video-slider__loader-icon_active":null),i=p();C(()=>{V(),window.addEventListener("resize",V)}),U(()=>{window.removeEventListener("resize",V)});const u=p(),{onSwipe:z,onMove:m,onDrop:_}=W(u,{move:{limit:300}}),{onScroll:x}=te(u),O=(e,d=!1)=>{if(!["up","down"].includes(e)||b.value&&s.value)return;X(e===(d?"down":"up"))};z(e=>{if(!(b.value&&s.value)){if(r.value=0,o.value=0,t.value===0&&e==="down"){g.value=!0;return}O(e,!0)}}),m(e=>{b.value&&s.value||(t.value===0&&e.y>0&&(o.value=e.y*-1),r.value=e.y)}),_(()=>{r.value=0});const F=R(O,250);x(e=>F(e));const X=(e=!1)=>{const d=e?-1:1,h=Math.max(0,Math.min(t.value+d,l.items.length-1));h!==t.value&&(t.value=h)},M=se(),{offset:j,expanded:b}=Y(M),V=()=>{if(!(u!=null&&u.value))return;let e=0;i!=null&&i.value&&(e-=i.value.clientHeight);const d=u.value.querySelector(".video-slider__item");d&&(e-=t.value*d.clientHeight),M.setOffset(e)},P=()=>{M.switchExpanded()};return(e,d)=>{const h=q("gc-icon");return S(),w("div",{ref_key:"sliderRef",ref:u,class:"video-slider"},[T("div",{class:"video-slider__wrapper",style:B(n.value)},[T("div",{ref_key:"loaderRef",ref:i,class:"video-slider__loader"},[y(h,{class:K(["video-slider__loader-icon",E.value]),name:"sync",color:"primary",size:"lg",style:B(v.value)},null,8,["class","style"])],512),(S(!0),w(Q,null,Z(e.items,(f,k)=>(S(),w("div",{key:k,"data-scroll-index":k,"data-item-active":k===t.value,class:"video-slider__item"},[y(A,{id:f.id,title:f.title,username:f.username,comments:f.comments,url:f.url,src:f.video.assets.source.url,"lazy-src":f.images.downsized.url,tags:f.tags,expanded:c(b),preview:k!==t.value,onExpand:P},null,8,["id","title","username","comments","url","src","lazy-src","tags","expanded","preview"])],8,oe))),128))],4)],512)}}}),le={class:"recommendations-page"},ne={key:0,class:"recommendations-page__controls"},ce=$({__name:"recommendations",setup(a){const{isTablet:l}=N(),t=ee(),{getRecommendations:g,setRecommendation:s,flushRecommendations:r}=t,{currentRecommendation:n,recommendations:o}=Y(t),v=p(!1);C(()=>{o.value.length||u(!0)}),H(()=>n.value,m=>{m<o.value.length-1||u()});const E=()=>{n.value!==0&&s(n.value-1)},i=()=>{n.value!==o.value.length-1&&s(n.value+1)},u=(m=!1)=>{let _=o.value.length;m&&(_=0,r()),v.value=!0,g(_).finally(()=>v.value=!1)},z=m=>{m&&u(!0)};return(m,_)=>{const x=q("gc-button");return S(),w("div",le,[y(ae,{"model-value":c(n),class:"recommendations-page__slider",items:c(o),loading:v.value&&!c(o).length,"onUpdate:loading":z,"onUpdate:modelValue":c(s)},null,8,["model-value","items","loading","onUpdate:modelValue"]),c(l)?I("",!0):(S(),w("div",ne,[y(x,{icon:"arrow-back-ios-new",size:"lg",disabled:c(n)===0,onClick:E},null,8,["disabled"]),y(x,{icon:"arrow-back-ios-new",size:"lg",loading:v.value,disabled:c(n)===c(o).length-1,onClick:i},null,8,["loading","disabled"])]))])}}});export{ce as default};
