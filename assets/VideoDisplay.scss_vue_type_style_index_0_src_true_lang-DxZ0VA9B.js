import{f as G,r as _,v as J,o as B,g as O,d as k,e as d,c as g,k as f,x as b,F as U,p as H,y as X,z as K,j as P,A as Q,B as Z,s as R,i as C,b as $,h as ee,u as Y,q as z,w as A,t as x,C as I,D as W,E as j,G as N,n as oe,l as te}from"./index-BdAOosat.js";import{u as se}from"./useMockApi-gST0Mk85.js";const ne=G("videoPlayer",()=>{const i=_(parseInt(localStorage.getItem("videoPlayerVolume")||"15"));return{volume:i,setVolume:o=>{localStorage.setItem("videoPlayerVolume",o.toString()),i.value=o}}}),ae={threshold:50},le={preventDefault:{x:!0,y:!0},threshold:15},re=(i,l={})=>{const o={swipe:{...ae,...l.swipe||{}},move:{...le,...l.move||{}}},n=J({swipe:[],move:[],drop:[]}),r=_(0),s=_(0),u=_(null),y=e=>{e.touches.length&&(u.value=null,r.value=e.touches[0].clientX,s.value=e.touches[0].clientY)},h=e=>{var c,L,M,T,F;if(!e.touches.length)return;const p=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY,S=p-r.value,m=a-s.value,t=Math.abs(S),V=Math.abs(m);!u.value&&(t>(((c=o.move)==null?void 0:c.threshold)??0)||V>(((L=o.move)==null?void 0:L.threshold)??0))&&(u.value=t>V?"x":"y"),u.value&&((T=(M=o.move)==null?void 0:M.preventDefault)!=null&&T[u.value])&&e.preventDefault(),!((F=o.move)!=null&&F.limit&&(u.value==="x"&&t>o.move.limit||u.value==="y"&&V>o.move.limit))&&n.move.forEach(q=>q({x:u.value==="y"?0:S,y:u.value==="x"?0:m}))},v=e=>{var L,M;if(!e.changedTouches.length||!n.swipe.length)return;const p=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY,S=p-r.value,m=a-s.value,t=Math.abs(S),V=Math.abs(m);let c;if(V>t&&u.value==="y"){if(V<=(((L=o.swipe)==null?void 0:L.threshold)??0)){n.drop.forEach(T=>T());return}c=m>0?"down":"up"}else{if(t<=(((M=o.swipe)==null?void 0:M.threshold)??0)){n.drop.forEach(T=>T());return}c=S>0?"right":"left"}n.swipe.forEach(T=>T(c))};return B(()=>{const e=i==null?void 0:i.value;e&&(e.addEventListener("touchstart",y,{passive:!0}),e.addEventListener("touchmove",h),e.addEventListener("touchend",v,{passive:!0}))}),O(()=>{const e=i==null?void 0:i.value;e&&(e.removeEventListener("touchstart",y),e.removeEventListener("touchmove",h),e.removeEventListener("touchend",v))}),{onSwipe:e=>(n.swipe.push(e),()=>{n.swipe=n.swipe.filter(p=>p!==e)}),onMove:e=>(n.move.push(e),()=>{n.move=n.move.filter(p=>p!==e)}),onDrop:e=>(n.drop.push(e),()=>{n.drop=n.drop.filter(p=>p!==e)})}},ie="/giphy-clips/images/Avatar.png",ue={class:"video-display-comments-item"},ce={class:"video-display-comments-item__data"},de={class:"video-display-comments-item__username"},pe={class:"video-display-comments-item__text"},ve=k({__name:"VideoDisplayCommentsItem",props:{username:{},text:{}},setup(i){return(l,o)=>(d(),g("li",ue,[o[0]||(o[0]=f("img",{class:"video-display-comments-item__avatar",src:ie},null,-1)),f("div",ce,[f("div",de,b(l.username),1),f("p",pe,b(l.text),1)])]))}}),me={class:"video-display-comments"},_e={class:"video-display-comments__heading"},ye={class:"video-display-comments__list"},he=k({__name:"VideoDisplayComments",props:{items:{}},setup(i){return(l,o)=>(d(),g("div",me,[f("h4",_e," Comments ("+b(l.items.length)+") ",1),f("ul",ye,[(d(!0),g(U,null,H(l.items,(n,r)=>(d(),X(ve,K({key:r,ref_for:!0},n),null,16))),128))])]))}}),fe={class:"video-display-header"},ge={class:"video-display-header__username"},we={class:"video-display-header__title"},Ve=k({__name:"VideoDisplayHeader",props:{title:{},username:{}},setup(i){return(l,o)=>(d(),g("header",fe,[f("h3",ge,b(l.username||"Loading.."),1),o[0]||(o[0]=f("span",{class:"video-display-header__dot"},null,-1)),f("h2",we,b(l.title||"Loading.."),1)]))}}),$e={class:"video-display-tags"},De=k({__name:"VideoDisplayTags",props:{items:{}},setup(i){return(l,o)=>{const n=P("gc-badge");return d(),g("div",$e,[(d(!0),g(U,null,H(l.items,(r,s)=>(d(),X(n,{key:s},{default:Q(()=>[Z(b(r),1)]),_:2},1024))),128))])}}}),Se={class:"video-player-actions"},ke=k({__name:"VideoPlayerActions",props:{id:{},loading:{type:Boolean,default:!1}},emits:["click:comment","click:explore"],setup(i,{emit:l}){const o=i,n=l,r=se(),{favorites:s}=R(r),{switchFavorite:u}=r,y=C(()=>o.id&&s.value.includes(o.id)?"favorite":"favorite-outline"),h=()=>{o.id&&u(o.id)},v=()=>n("click:comment"),D=()=>n("click:explore");return(w,E)=>{const e=P("gc-button");return d(),g("div",Se,[$(e,{size:"lg",icon:y.value,loading:w.loading,onClick:h},null,8,["icon","loading"]),$(e,{size:"lg",icon:"mark-unread-chat-alt-outline",loading:w.loading,onClick:v},null,8,["loading"]),$(e,{icon:"open-in-new",color:"primary",size:"lg",loading:w.loading,onClick:D},null,8,["loading"])])}}}),Ee={class:"video-player-footer"},Te={class:"video-player-footer__username"},be={class:"video-player-footer__title"},Ce=k({__name:"VideoPlayerFooter",props:{username:{},title:{},progress:{default:0}},setup(i){return(l,o)=>{const n=P("gc-progressbar");return d(),g("footer",Ee,[f("h4",Te,b(l.username||"Loading.."),1),f("h4",be,b(l.title||"Loading.."),1),$(n,{"model-value":l.progress},null,8,["model-value"])])}}}),Le={class:"video-player-header"},Me=k({__name:"VideoPlayerHeader",props:{volume:{default:15},volumeModifiers:{}},emits:["update:volume"],setup(i){const l=ee(i,"volume"),{isTablet:o}=Y();return(n,r)=>{const s=P("gc-volume-input");return d(),g("header",Le,[$(s,{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=u=>l.value=u),expanded:z(o)},null,8,["modelValue","expanded"])])}}}),Pe={class:"video-player-source"},ze=["src"],xe=["muted","src"],Xe=["src"],Ae=k({__name:"VideoPlayerSource",props:{src:{},lazySrc:{},preview:{type:Boolean,default:!0},volume:{default:15}},emits:["play","pause","changeDuration","changeTime","loading"],setup(i,{expose:l,emit:o}){const n=i,r=o,s=_(),u=_(!n.preview),y=_(!0),h=t=>{s!=null&&s.value&&(s.value.volume=t/100)},v=()=>{var t;if(n.preview){(t=s.value)==null||t.removeEventListener("timeupdate",w),I(()=>u.value=!0);return}u.value=!1,I(()=>{var V;h(n.volume),S(),(V=s.value)==null||V.addEventListener("timeupdate",w)})};B(()=>v()),O(()=>v()),A(()=>n.volume,h),A(()=>n.preview,v);const D=C(()=>n.volume===0),w=()=>{s!=null&&s.value&&(r("changeDuration",Number(s.value.duration)),r("changeTime",Number(s.value.currentTime)))},E=()=>r("play"),e=()=>r("pause"),p=()=>{y.value=!0,r("loading",!0)},a=()=>{y.value=!1,r("loading",!1)},S=()=>{var t;return(t=s.value)==null?void 0:t.play()};return l({playVideo:S,pauseVideo:()=>{var t;return(t=s.value)==null?void 0:t.pause()}}),(t,V)=>(d(),g("div",Pe,[t.preview||y.value?(d(),g("img",{key:0,class:"video-player-source__preview",src:t.lazySrc},null,8,ze)):x("",!0),u.value?x("",!0):(d(),g("video",{key:1,ref_key:"videoBaseRef",ref:s,class:"video-player-source__base",crossorigin:"anonymous",mediatype:"video",preload:"auto",muted:D.value,src:t.src,playsinline:"",autoplay:"",loop:"",onPlay:E,onPause:e,onLoadstart:p,onCanplaythrough:a},null,40,xe)),f("img",{class:"video-player-source__lazy",src:t.lazySrc},null,8,Xe)]))}}),Be={class:"video-player"},Oe=k({__name:"VideoPlayer",props:{id:{},url:{},title:{},username:{},src:{},lazySrc:{},preview:{type:Boolean,default:!0}},emits:["click:comment"],setup(i,{emit:l}){const o=i,n=l,{isTablet:r}=Y(),s=_(),u=_(!1),y=_(!0),h=_(!0),v=ne(),D=C({get:()=>v.volume,set:m=>v.setVolume(m)}),w=_(0),E=_(0),e=C(()=>w.value===0?0:100*E.value/w.value),p=()=>{h.value||!(s!=null&&s.value)||s.value[y.value?"playVideo":"pauseVideo"]()},a=()=>n("click:comment"),S=()=>{s.value&&(window.open(o.url,"_blank"),s.value.pauseVideo())};return(m,t)=>{const V=P("gc-icon");return d(),g("div",Be,[f("div",{class:"video-player__overlay",onClick:N(p,["self"]),onMouseenter:t[1]||(t[1]=c=>u.value=!0),onMouseleave:t[2]||(t[2]=c=>u.value=!1)},[W($(Me,{volume:D.value,"onUpdate:volume":t[0]||(t[0]=c=>D.value=c)},null,8,["volume"]),[[j,u.value&&!h.value&&!z(r)]]),y.value&&!h.value&&!m.preview?(d(),X(V,{key:0,class:"video-player__overlay-pause",name:"play-arrow",size:"6rem",onClick:N(p,["stop"])})):x("",!0),$(Ce,{title:m.title,username:m.username,progress:e.value},null,8,["title","username","progress"]),$(ke,{id:m.id,loading:h.value,"onClick:explore":S,"onClick:comment":a},null,8,["id","loading"])],32),$(Ae,{ref_key:"videoSourceRef",ref:s,src:m.src,"lazy-src":m.lazySrc,volume:D.value,preview:m.preview,onPlay:t[3]||(t[3]=c=>y.value=!1),onPause:t[4]||(t[4]=c=>y.value=!0),onLoading:t[5]||(t[5]=c=>h.value=c),onChangeTime:t[6]||(t[6]=c=>E.value=c),onChangeDuration:t[7]||(t[7]=c=>w.value=c)},null,8,["src","lazy-src","volume","preview"])])}}}),Ye={class:"video-display__data"},Ne=k({__name:"VideoDisplay",props:{id:{default:""},url:{default:""},src:{default:""},lazySrc:{default:""},tags:{default:()=>[]},comments:{default:()=>[]},preview:{type:Boolean,default:!0},expanded:{type:Boolean,default:!1},title:{default:""},username:{default:""}},emits:["expand"],setup(i,{emit:l}){const o=i,n=l;B(()=>{e(),window.addEventListener("resize",e)}),O(()=>{window.removeEventListener("resize",e)}),A(()=>o.expanded,()=>{r.value&&e()});const{isTablet:r}=Y(),s=_(),{onSwipe:u,onMove:y,onDrop:h}=re(s,{move:{preventDefault:{y:!1},limit:300}}),v=_(0),D=_(0);u(a=>{!["left","right"].includes(a)||a==="right"&&!o.expanded||a==="left"&&o.expanded||p()}),y(a=>{o.expanded&&a.x<0||!o.expanded&&a.x>0||!r.value||(v.value=a.x)}),h(()=>v.value=0);const w=C(()=>({transform:`translateX(${D.value+v.value}px)`})),E=C(()=>o.expanded?"video-display_expanded":null),e=()=>{!r.value||!s.value||(v.value=0,D.value=o.expanded?-(s.value.clientWidth/2):0)},p=()=>n("expand");return(a,S)=>(d(),g("div",{ref_key:"displayRef",ref:s,class:oe(["video-display",E.value]),style:te(w.value)},[$(Oe,{class:"video-display__player",id:a.id,title:a.title,username:a.username,url:a.url,src:a.src,"lazy-src":a.lazySrc,preview:a.preview||a.expanded&&z(r),"onClick:comment":p},null,8,["id","title","username","url","src","lazy-src","preview"]),W(f("div",Ye,[$(Ve,{title:a.title,username:a.username},null,8,["title","username"]),a.tags.length?(d(),X(De,{key:0,items:a.tags},null,8,["items"])):x("",!0),$(he,{items:a.comments},null,8,["items"])],512),[[j,a.expanded||z(r)]])],6))}});export{Ne as _,re as u};
